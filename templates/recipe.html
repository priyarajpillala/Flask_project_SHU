{% extends "base.html" %}
{% block content %}

<h1>{{ recipe.title }}</h1>

<p><strong>Cuisine:</strong> {{ recipe.cuisine }}</p>
<p><strong>Ingredients:</strong></p>
<p>{{ recipe.ingredients }}</p>

<p><strong>Steps:</strong></p>
<p>{{ recipe.steps }}</p>

{% if user_id %}
    {% if user_id == recipe.user_id or is_admin %}
        <a href="/update/{{ recipe.id }}/">Edit</a>
        <a href="/delete/{{ recipe.id }}/">Delete</a>
    {% endif %}
{% endif %}

<hr>

{% if user_id %}
    <form method="POST" action="{% if saved %}/unsave-recipe/{{ recipe.id }}/{% else %}/save-recipe/{{ recipe.id }}/{% endif %}">
        <button type="submit">
            {% if saved %}Unsave{% else %}Save{% endif %} Recipe
        </button>
    </form>
{% endif %}

<hr>

<h3>Comments</h3>

{% if user_id %}
    <form method="POST">
        <textarea name="comment" rows="3" placeholder="Add your comment" required></textarea><br>
        <button type="submit">Post Comment</button>
    </form>
{% else %}
    <p><a href="/login/">Login</a> to comment.</p>
{% endif %}

<ul>
{% for c in comments %}
    <li>
        <strong>{{ c.username }}</strong> ({{ c.created }}): {{ c.content }}

        {% if is_admin %}
            <form method="POST" action="/admin/delete-comment/{{ c.id }}/" style="display:inline;">
                <button type="submit">Delete</button>
            </form>
        {% elif user_id == c.user_id %}
            <form method="POST" action="/delete-comment/{{ c.id }}/" style="display:inline;">
                <button type="submit">Delete</button>
            </form>
        {% endif %}
    </li>
{% else %}
    <li>No comments yet.</li>
{% endfor %}
</ul>


{% endblock %}
